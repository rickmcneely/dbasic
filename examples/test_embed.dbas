' Test EMBED, ANY, and ERROR types

TYPE BaseType
    DIM name AS STRING
END TYPE

TYPE Contact
    DIM FirstName AS STRING
    DIM LastName AS STRING
END TYPE

' Test type embedding
TYPE ContactModel
    EMBED walk.TableModelBase
    EMBED walk.SorterBase
    DIM sortColumn AS INTEGER
    DIM items AS []Contact
END TYPE

' Test ANY return type (maps to interface{})
FUNCTION (m AS POINTER TO ContactModel) Value(row AS INTEGER, col AS INTEGER) AS ANY
    IF row < 0 THEN
        RETURN NIL
    END IF
    SELECT CASE col
        CASE 0
            RETURN "First"
        CASE 1
            RETURN "Last"
    END SELECT
    RETURN NIL
END FUNCTION

' Test ERROR return type (maps to error)
FUNCTION (m AS POINTER TO ContactModel) Sort(col AS INTEGER) AS ERROR
    (^m).sortColumn = col
    RETURN NIL
END FUNCTION

' Test INTEGER return type (existing)
FUNCTION (m AS POINTER TO ContactModel) RowCount() AS INTEGER
    RETURN LEN((^m).items)
END FUNCTION

SUB Main()
    PRINT "Interface support test"
END SUB
